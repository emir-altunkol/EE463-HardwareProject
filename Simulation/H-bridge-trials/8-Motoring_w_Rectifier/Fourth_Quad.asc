Version 4
SHEET 1 4824 680
WIRE 848 -1072 816 -1072
WIRE 960 -1072 928 -1072
WIRE 1312 -1072 1280 -1072
WIRE 1424 -1072 1392 -1072
WIRE 848 -912 816 -912
WIRE 960 -912 928 -912
WIRE 1312 -912 1280 -912
WIRE 1424 -912 1392 -912
WIRE 1216 -736 1184 -736
WIRE 1328 -736 1296 -736
WIRE 2400 -304 1984 -304
WIRE 3632 -304 3216 -304
WIRE 1616 -272 1616 -320
WIRE 1984 -272 1984 -304
WIRE 2848 -272 2848 -320
WIRE 3216 -272 3216 -304
WIRE 2400 -256 2400 -304
WIRE 3632 -256 3632 -304
WIRE 1616 -144 1616 -192
WIRE 2848 -144 2848 -192
WIRE 112 -128 -32 -128
WIRE 192 -128 176 -128
WIRE 464 -128 192 -128
WIRE 688 -128 464 -128
WIRE 1104 -128 688 -128
WIRE 1984 -112 1984 -192
WIRE 2016 -112 1984 -112
WIRE 688 -96 688 -128
WIRE 1104 -96 1104 -128
WIRE 3216 -96 3216 -192
WIRE 3248 -96 3216 -96
WIRE 2400 -80 2400 -176
WIRE 3632 -80 3632 -176
WIRE 464 -64 464 -128
WIRE 4000 -64 4000 -112
WIRE 192 -48 192 -128
WIRE 1616 16 1616 -64
WIRE 2848 16 2848 -64
WIRE 688 48 688 0
WIRE 688 48 672 48
WIRE 1104 48 1104 0
WIRE 1104 48 1088 48
WIRE 4000 48 4000 16
WIRE -32 64 -32 -128
WIRE 3248 64 3216 64
WIRE 192 80 192 -48
WIRE 464 80 464 16
WIRE 464 96 464 80
WIRE 688 96 688 48
WIRE 816 96 688 96
WIRE 1104 96 1104 48
WIRE 1104 96 976 96
WIRE 2400 128 2400 0
WIRE 3632 128 3632 0
WIRE 688 192 688 96
WIRE 1104 192 1104 96
WIRE 2016 192 1984 192
WIRE 1616 208 1616 96
WIRE 2848 208 2848 96
WIRE 464 224 464 176
WIRE 464 224 448 224
WIRE 688 304 688 288
WIRE 688 304 672 304
WIRE 1104 304 1104 288
WIRE 1104 304 1088 304
WIRE 1616 304 1616 288
WIRE 1984 304 1984 192
WIRE 2128 304 1984 304
WIRE 2400 304 2400 208
WIRE 2400 304 2128 304
WIRE 2848 304 2848 288
WIRE 3216 304 3216 64
WIRE 3360 304 3216 304
WIRE 3632 304 3632 208
WIRE 3632 304 3360 304
WIRE -32 320 -32 144
WIRE 192 320 192 144
WIRE 192 320 -32 320
WIRE 464 320 464 224
WIRE 464 320 192 320
WIRE 688 320 688 304
WIRE 688 320 464 320
WIRE 1104 320 1104 304
WIRE 1104 320 688 320
WIRE -32 352 -32 320
FLAG -32 352 0
FLAG 640 -16 V_G1
IOPIN 640 -16 In
FLAG 640 272 V_G2
IOPIN 640 272 In
FLAG 1056 -16 V_G3
IOPIN 1056 -16 In
FLAG 1056 272 V_G4
IOPIN 1056 272 In
FLAG 1088 48 V_S3
IOPIN 1088 48 In
FLAG 672 48 V_S1
IOPIN 672 48 In
FLAG 672 304 V_S2
IOPIN 672 304 In
FLAG 1088 304 V_S4
IOPIN 1088 304 In
FLAG 960 -1072 V_G1
IOPIN 960 -1072 Out
FLAG 816 -1072 V_S1
IOPIN 816 -1072 Out
FLAG 960 -912 V_G2
IOPIN 960 -912 Out
FLAG 816 -912 V_S2
IOPIN 816 -912 Out
FLAG 1424 -1072 V_G3
IOPIN 1424 -1072 Out
FLAG 1280 -1072 V_S3
IOPIN 1280 -1072 Out
FLAG 1424 -912 V_G4
IOPIN 1424 -912 Out
FLAG 1280 -912 V_S4
IOPIN 1280 -912 Out
FLAG 1616 -320 HB+
IOPIN 1616 -320 In
FLAG 816 96 HB+
IOPIN 816 96 Out
FLAG 976 96 HB-
IOPIN 976 96 Out
FLAG 1616 304 HB-
IOPIN 1616 304 In
FLAG 416 160 V_G5
IOPIN 416 160 In
FLAG 448 224 V_S5
IOPIN 448 224 In
FLAG 1328 -736 V_G5
IOPIN 1328 -736 Out
FLAG 1184 -736 V_S5
IOPIN 1184 -736 Out
FLAG -240 -1088 0
FLAG -640 -1088 0
FLAG -240 -1168 tri
FLAG -640 -1168 ref1
FLAG 304 -1088 0
FLAG 304 -1168 out1
FLAG 304 -896 0
FLAG 304 -976 out2
FLAG -640 -848 0
FLAG -640 -928 ref2
FLAG -240 -864 0
FLAG -240 -944 ref5
FLAG 2128 384 0
FLAG 2848 -320 Va_Motor+
IOPIN 2848 -320 In
FLAG 2848 304 Va_Motor-
IOPIN 2848 304 In
FLAG 3360 384 0
FLAG 4000 -112 Va_Motor+
IOPIN 4000 -112 Out
FLAG 4000 48 Va_Motor-
IOPIN 4000 48 Out
FLAG 304 -672 0
FLAG 304 -752 out5
FLAG 3248 -96 Speed_couple-
FLAG 3248 64 Speed_couple+
FLAG 2016 -112 Speed_couple+
FLAG 2016 192 Speed_couple-
FLAG 192 -48 V_Rect
SYMBOL nmos 640 -96 R0
SYMATTR InstName M1
SYMATTR Value IXTH88N30P
SYMBOL nmos 1056 -96 R0
SYMATTR InstName M3
SYMATTR Value IXTH88N30P
SYMBOL voltage 3264 -896 R90
WINDOW 0 37 30 VLeft 2
WINDOW 3 -55 363 VLeft 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 10 0.02866m 1p 1p 0.02134m 0.05m 400)
SYMBOL voltage 3264 -1040 R90
WINDOW 0 37 30 VLeft 2
WINDOW 3 -49 364 VLeft 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 10 0 1p 1p 0.02866m 0.05m)
SYMBOL voltage 1408 -1072 R90
WINDOW 0 -56 90 VLeft 2
WINDOW 3 48 70 VLeft 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_GS3
SYMATTR Value 0
SYMBOL voltage 1616 192 R0
SYMATTR InstName Sense_Ia
SYMATTR Value 0
SYMBOL voltage 2400 112 R0
SYMATTR InstName Sense_wm
SYMATTR Value 0
SYMBOL ind 1600 -288 R0
SYMATTR InstName Motor_inductance
SYMATTR Value {L_motor}
SYMBOL ind 2384 -272 R0
SYMATTR InstName Inertia_constant
SYMATTR Value {L_inertia}
SYMBOL res 1600 -160 R0
SYMATTR InstName Motor_resistance
SYMATTR Value {R_motor}
SYMBOL res 2384 -96 R0
SYMATTR InstName Friction
SYMATTR Value {R_loss}
SYMBOL bv 1984 -288 R0
SYMATTR InstName V_torque
SYMATTR Value V=I(Sense_Ia)*K_t
SYMBOL voltage 2672 -1040 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 -169 9 Left 2
WINDOW 3 -345 136 Left 2
SYMATTR InstName V_DC_CONST
SYMATTR Value PWL(0 0 10m 320 40m 320 40.000001m 320 50m 320)
SYMBOL nmos 640 192 R0
SYMATTR InstName M2
SYMATTR Value IXTH88N30P
SYMBOL nmos 1056 192 R0
SYMATTR InstName M4
SYMATTR Value IXTH88N30P
SYMBOL nmos 416 80 R0
SYMATTR InstName M5
SYMATTR Value IXTH88N30P
SYMBOL res 448 -80 R0
WINDOW 0 -97 43 Left 2
WINDOW 3 -71 69 Left 2
SYMATTR InstName R_chop
SYMATTR Value 26
SYMBOL bv 2096 -1072 R0
SYMATTR InstName Back_emf1
SYMATTR Value V=200*K_emf
SYMBOL cap 176 80 R0
SYMATTR InstName C_Rect
SYMATTR Value 10µ
SYMBOL voltage -240 -1184 R0
WINDOW 3 -221 137 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 10 0 0.025m 0.025m 1n 0.05m)
SYMATTR InstName V_triangle
SYMBOL voltage -640 -1184 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -208 129 Left 2
SYMATTR Value PULSE(5 9 50m 1n 1n 25m 50m)
SYMATTR InstName V_ref_1
SYMBOL bv 304 -1184 R0
WINDOW 3 -146 129 Left 2
SYMATTR Value V{if(V(tri)<V(ref1),10,0)}
SYMATTR InstName V_drive_1
SYMBOL bv 304 -992 R0
WINDOW 3 -138 143 Left 2
SYMATTR Value V{if(V(tri)<V(ref2),0,10)}
SYMATTR InstName V_drive_2
SYMBOL voltage -640 -944 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -204 140 Left 2
SYMATTR Value PULSE(5.5 9.5 50m 1n 1n 25m 50m)
SYMATTR InstName V_ref_2
SYMBOL diode 112 -112 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D_Rect
SYMBOL voltage 1408 -912 R90
WINDOW 0 -54 88 VLeft 2
WINDOW 3 51 70 VLeft 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_GS4
SYMATTR Value 10
SYMBOL bv 1312 -736 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V_GS5
SYMATTR Value V=0
SYMBOL voltage -240 -960 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -194 135 Left 2
SYMATTR Value PULSE(0 10 24m 10m 80m 1000)
SYMATTR InstName V_ref_5
SYMBOL bv 944 -912 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V_GS2
SYMATTR Value V=V{out2}
SYMBOL bv 944 -1072 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName V_GS1
SYMATTR Value V=V{out1}
SYMBOL res 2112 288 R0
SYMATTR InstName R_GND1
SYMATTR Value 100Meg
SYMBOL bv 1616 0 R0
SYMATTR InstName Back_emf_gen
SYMATTR Value V=I(Sense_wm)*K_emf
SYMBOL voltage 2848 192 R0
SYMATTR InstName Sense_Ia1
SYMATTR Value 0
SYMBOL voltage 3632 112 R0
SYMATTR InstName Sense_wm1
SYMATTR Value 0
SYMBOL ind 2832 -288 R0
SYMATTR InstName Motor_inductance1
SYMATTR Value {L_motor}
SYMBOL ind 3616 -272 R0
SYMATTR InstName Inertia_constant1
SYMATTR Value {L_inertia}
SYMBOL res 2832 -160 R0
SYMATTR InstName Motor_resistance1
SYMATTR Value {R_motor}
SYMBOL res 3616 -96 R0
SYMATTR InstName Friction1
SYMATTR Value {R_loss}
SYMBOL bv 3216 -288 R0
SYMATTR InstName V_torque1
SYMATTR Value V=I(Sense_Ia1)*K_t
SYMBOL res 3344 288 R0
SYMATTR InstName R_GND2
SYMATTR Value 100Meg
SYMBOL bv 2848 0 R0
SYMATTR InstName Back_emf_mot
SYMATTR Value V=I(Sense_wm1)*K_emf
SYMBOL voltage 4432 192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Va_Motor
SYMATTR Value ""
SYMBOL voltage -368 16 R0
SYMATTR InstName V_DC
SYMATTR Value 200
SYMBOL bv 304 -768 R0
WINDOW 3 -138 143 Left 2
SYMATTR Value V{if(V(tri)<V(ref5),10,0)}
SYMATTR InstName V_drive_5
SYMBOL res 3984 -80 R0
SYMATTR InstName R_Load
SYMATTR Value 16
SYMBOL voltage -32 48 R0
WINDOW 3 -189 129 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_DC_Rectified
SYMATTR Value PWL file=Rectifier_Three_Phase.txt
TEXT -344 256 Left 2 !.tran 0 100m 50m 0.005m
TEXT 2040 -8 Left 2 !.PARAM K_t=0.2\n.PARAM K_emf = 0.25\n.PARAM L_motor = 1000u\n.PARAM R_motor =1.2\n.PARAM R_loss = 0.0001\n.PARAM L_inertia =20u
TEXT 2088 432 Left 0 ;LTspice is angry when there is a floating net.
TEXT 3320 432 Left 0 ;LTspice is angry when there is a floating net.
TEXT 1904 -456 Left 5 ;DC Machine Model
TEXT 2000 -416 Left 2 ;to which driver is connected
TEXT 3176 -464 Left 5 ;DC Machine Model
TEXT 3296 -424 Left 2 ;which is coupled to the other
TEXT 48 -200 Left 0 ;D_Rect is here to ensure no reverse current\nflows to the rectifier, which is the real case.
TEXT 784 -1160 Left 0 ;PWM is adjusted by comparing pulses with\na triangular wave, then applied to the gate.
TEXT 2360 -1208 Left 5 ;Recycle Bin
TEXT 200 -264 Left 5 ;Rectifier + Chopper + H-Bridge
TEXT 616 -1280 Left 5 ;Gate Driver
TEXT -576 -1288 Left 5 ;Controller
TEXT 208 56 Left 0 ;Capacitance models the\ncapacitor at rectifier output
